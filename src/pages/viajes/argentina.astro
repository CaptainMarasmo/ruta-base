---
import BaseLayout from "../../layouts/BaseLayout.astro";
import itinerarioRaw from "../../data/argentina.js";
import Imprescindibles3D from "../../components/Imprescindibles3D.jsx";

type Dia = {
  day: number;
  title: string;
  text?: string;
};

const itinerario: Dia[] = Array.isArray(itinerarioRaw)
  ? [...(itinerarioRaw as Dia[])].sort((a, b) => (a.day ?? 0) - (b.day ?? 0))
  : [];

const daysSet = new Set(itinerario.map((d) => d.day));

const nextExistingDay = (day: number): number | null => {
  for (let i = day + 1; i <= 365; i++) {
    if (daysSet.has(i)) return i;
  }
  return null;
};
---

<BaseLayout title="Argentina | Ruta Base">
  <style>
    .hero{
      position: relative;
      border-radius: 16px;
      overflow: hidden;
      border: 0;
      box-shadow: none;
      background: transparent;
      margin-bottom: 12px;
    }

    .heroImg{     object-position: 30% 15%;
      width: 100%;
      height: 320px;
      object-fit: cover;
      display: block;
      border-radius: 16px;
      border: 1px solid rgba(0,0,0,0.08);
      box-shadow: 0 10px 24px rgba(0,0,0,0.10);
    }

    .pad{
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      padding: 10px;
      display: flex;
      justify-content: flex-start;
      background: linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0.35) 100%);
      z-index: 2;
    }
    .caption{
      display: inline-block;
      padding: 4px 8px;
      border-radius: 10px;
      background: rgba(255,255,255,0.35);
      border: 1px solid rgba(0,0,0,0.1);
      margin: 0;
      font-size: 13px;
      font-weight: 600;
      font-style: italic;
      color: #fff;
      text-shadow: 0 1px 2px rgba(0,0,0,0.35);
    }

    .pageTitle{
      margin-top: 0;
      margin-bottom: 10px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .flag-arg{
      height: 28px;
      width: auto;
      display: inline-block;
      border-radius: 3px;
      border: 1px solid rgba(0,0,0,0.15);
      box-shadow: 0 1px 3px rgba(0,0,0,0.15);
      vertical-align: -0.1em;
      object-fit: contain;
    }

    .toc{
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 10px 0 16px;
      position: sticky;
      top: 10px;
      z-index: 5;
      backdrop-filter: blur(6px);
      background: rgba(255,255,255,0.7);
      padding: 8px;
      border-radius: 12px;
    }

    .toc a{
      display: inline-block;
      text-decoration: none;
      color: #1a0b2e;
      padding: 6px 10px;
      border-radius: 10px;
      background: rgba(255,255,255,0.65);
      border: 1px solid rgba(0,0,0,0.08);
      font-weight: 700;
      font-size: 13px;
    }

    .toc a:hover{
      background: rgba(155,120,255,0.22);
    }

    /* Secciones plegables */
    details.sec{
      border: 1px solid rgba(0,0,0,0.08);
      border-radius: 14px;
      background: rgba(255,255,255,0.75);
      margin-bottom: 12px;
      overflow: hidden;
    }

    summary.secSummary{
      list-style: none;
      cursor: pointer;
      padding: 14px;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      color: #1a0b2e;
      font-weight: 900;
      font-size: 18px;
    }
    /* Solo TOC arriba: ocultar títulos repetidos */
    summary.secSummary{ display: none; }

    summary.secSummary::-webkit-details-marker{ display:none; }

    .secCaret{
      font-size: 18px;
      opacity: 0.7;
      transform: rotate(-90deg);
      transition: transform 0.18s ease;
    }

    details[open] .secCaret{
      transform: rotate(0deg);
    }

    .secBody{
      padding: 0 14px 14px 14px;
      border-top: 1px solid rgba(0,0,0,0.08);
    }
    .hotelRow{
      display: flex;
      gap: 14px;
      flex-wrap: wrap;
      align-items: stretch;
    }
    .hotelCard{
      flex: 1 1 260px;
      border: 1px solid rgba(0,0,0,0.08);
      border-radius: 14px;
      padding: 12px;
      background: rgba(255,255,255,0.75);
      box-shadow: 0 8px 16px rgba(0,0,0,0.08);
    }
    .hotelName{
      font-weight: 800;
      margin: 0 0 6px;
    }
    .hotelMedia{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    .hotelPhoto{
      width: 100%;
      height: 120px;
      object-fit: cover;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,0.1);
      box-shadow: 0 6px 12px rgba(0,0,0,0.08);
    }
    .hotelInfo{
      display: grid;
      gap: 6px;
      margin-top: 10px;
    }
    .hotelInfo a{
      color: inherit;
      font-weight: 700;
    }
    .hotelMap{
      width: 100%;
      height: 240px;
      border: 0;
      border-radius: 12px;
      margin-top: 10px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.08);
    }
    .hotelItem{
      border: 1px solid rgba(0,0,0,0.08);
      border-radius: 14px;
      background: rgba(255,255,255,0.7);
      overflow: hidden;
    }
    .hotelToggle{
      width: 100%;
      text-align: left;
      padding: 12px 14px;
      font-weight: 800;
      font-size: 16px;
      background: transparent;
      border: 0;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: nowrap;
    }
    .hotelTitle{
      display: inline-flex;
      align-items: center;
      gap: 10px;
      white-space: nowrap;
    }
    .hotelStars{
      color: #f2c84b;
      text-shadow: 0 1px 0 rgba(0,0,0,0.15);
      font-size: 16px;
      letter-spacing: 1px;
    }
    .hotelToggle .hotelCaret{
      font-size: 18px;
      opacity: 0.7;
      transform: rotate(-90deg);
      transition: transform 0.18s ease;
    }
    .hotelItem.open .hotelToggle .hotelCaret{
      transform: rotate(0deg);
    }
    .hotelPanel{
      display: none;
      padding: 0 14px 14px 14px;
      border-top: 1px solid rgba(0,0,0,0.08);
    }
    .hotelItem.open .hotelPanel{
      display: block;
    }
    details.sec{
      border: 0;
      background: transparent;
      margin-bottom: 0;
    }
    details.sec[open]{
      border: 1px solid rgba(0,0,0,0.08);
      border-radius: 14px;
      background: rgba(255,255,255,0.75);
      margin-bottom: 12px;
    }
    /* Mostrar solo títulos; contenido visible solo al abrir */
    details.sec .secBody{ display: none; }
    details.sec[open] .secBody{ display: block; }

    .dots{
      color: #666;
      margin: 10px 0 0 0;
    }

    .impGrid{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 10px;
      margin-top: 6px;
    }

    .impGlow{
      position: relative;
      padding: 12px;
      border-radius: 16px;
      background: rgba(255,255,255,0.72);
      border: 1px solid rgba(0,0,0,0.08);
      overflow: visible;
    }

    .impGlow::before{
      content: "";
      position: absolute;
      inset: -10px;
      border-radius: 22px;
      background: linear-gradient(90deg, rgba(120,180,255,0.0) 0%, rgba(120,180,255,0.85) 20%, rgba(255,255,255,0.75) 50%, rgba(120,180,255,0.85) 80%, rgba(120,180,255,0.0) 100%);
      filter: blur(14px);
      opacity: 1;
      pointer-events: none;
      animation: none;
      z-index: 0;
    }

    .impGlow::after{
      content: "";
      position: absolute;
      inset: -4px;
      border-radius: 20px;
      border: 1px solid rgba(120,180,255,0.7);
      box-shadow: 0 0 14px rgba(120,180,255,0.35), 0 0 26px rgba(255,255,255,0.22);
      pointer-events: none;
      opacity: 0.9;
      z-index: 0;
    }

    .impGlow::marker{ content: ""; }

    .impGlow::backdrop{ }


    .impGlow > *{
      position: relative;
      z-index: 1;
    }


    .impCard{
      border: 1px solid rgba(255,255,255,0.35);
      border-radius: 14px;
      background: rgba(255,255,255,0.35);
      padding: 12px;
      box-shadow: 0 10px 24px rgba(16,24,40,0.12);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .impTitle{
      font-weight: 900;
      font-size: 15px;
      margin-bottom: 6px;
      color: #1a0b2e;
    }

    .impText{
      margin: 0;
      color: #222;
      line-height: 1.5;
      font-size: 13px;
    }

    :global(.imp3d){
      position: relative;
      perspective: 900px;
    }

    :global(.imp3d__grid){
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 12px;
    }

    :global(.impCard3d){
      position: relative;
      border-radius: 14px;
      background: rgba(255,255,255,0.45);
      border: 1px solid rgba(255,255,255,0.45);
      box-shadow: 0 8px 18px rgba(16,24,40,0.12);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      transform-style: preserve-3d;
      overflow: hidden;
      transition: box-shadow 0.22s ease, transform 0.22s ease;
    }

    :global(.impCard3d):hover{
      box-shadow: 0 18px 36px rgba(16,24,40,0.18), 0 8px 20px rgba(90,170,255,0.25);
    }

    :global(.impCard3d)::before{
      content: "";
      position: absolute;
      inset: -1px;
      border-radius: 16px;
      background: linear-gradient(90deg, rgba(120,180,255,0.2), rgba(255,255,255,0.25), rgba(120,180,255,0.2));
      box-shadow: 0 0 18px rgba(120,180,255,0.35);
      filter: blur(6px);
      opacity: 0.8;
      pointer-events: none;
    }

    :global(.impCard3d__inner){
      position: relative;
      padding: 14px;
      transform: translateZ(14px);
    }

    :global(.impCard3d__title){
      font-weight: 900;
      font-size: 15px;
      margin-bottom: 6px;
      color: #1a0b2e;
    }

    :global(.impCard3d__text){
      margin: 0;
      color: #222;
      line-height: 1.5;
      font-size: 13px;
    }



    /* Itinerario */
    .dayList{
      display: grid;
      gap: 10px;
      margin-top: 10px;
    }

    details.day{
      border: 1px solid rgba(0,0,0,0.08);
      border-radius: 12px;
      background: rgba(255,255,255,0.65);
      overflow: hidden;
    }

    summary.daySummary{
      list-style: none;
      cursor: pointer;
      padding: 12px;
      font-weight: 800;
      color: #1a0b2e;
      user-select: none;
    }

    summary.daySummary::-webkit-details-marker{ display:none; }

    .dayBody{
      padding: 0 12px 12px 12px;
      border-top: 1px solid rgba(0,0,0,0.08);
    }

    .dayText{
      margin: 10px 0 0 0;
      color: #222;
      line-height: 1.7;
      white-space: pre-wrap;
    }

    .nextRow{
      margin-top: 12px;
      display: flex;
      justify-content: flex-end;
    }

    .nextBtn{
      display: inline-block;
      text-decoration: none;
      color: #1a0b2e;
      font-weight: 800;
      font-size: 13px;
      padding: 8px 10px;
      border-radius: 10px;
      background: rgba(155,120,255,0.22);
      border: 1px solid rgba(155,120,255,0.45);
    }

    .nextBtn:hover{
      background: rgba(155,120,255,0.30);
    }

    /* MAPA (pequeño + clic para ampliar) */
    .mapWrap{
      display: flex;
      justify-content: center;
      margin-top: 10px;
    }

    .mapBox{
      width: 21%;
      max-width: 240px;
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid rgba(0,0,0,0.08);
      background: rgba(255,255,255,0.65);
    }

    .mapBtn{
      padding: 0;
      border: 0;
      background: transparent;
      cursor: pointer;
      display: block;
      width: 100%;
    }

    .mapImg{
      width: 100%;
      height: auto;
      display: block;
    }

    @media (max-width: 800px){
      .mapBox{ width: 55%; max-width: 340px; }
    }

    /* GALERIA */
    #galeria h3{
      margin: 14px 0 8px 0;
      font-size: 15px;
      color: #1a0b2e;
    }

    .videoGrid{
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 10px;
      margin-bottom: 18px;
    }

    @media (max-width: 900px){
      .videoGrid{ grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 520px){
      .videoGrid{ grid-template-columns: 1fr; }
    }

    .videoGrid iframe{
      width: 100%;
      aspect-ratio: 16 / 9;
      height: auto;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,0.10);
      background: rgba(0,0,0,0.04);
    }

    .videoBtn{
      padding: 0;
      border: 0;
      background: transparent;
      cursor: pointer;
      display: block;
    }

    .videoBtn iframe{
      pointer-events: none;
    }

    .videoGrid{
      grid-template-columns: repeat(2, 1fr);
    }

    .videoGrid iframe{
      min-height: 180px;
    }

    @media (max-width: 900px){
      .videoGrid{ grid-template-columns: 1fr; }
      .videoGrid iframe{ min-height: 200px; }
    }

    .photoGrid{
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .photoBtn{
      padding: 0;
      border: 0;
      background: transparent;
      cursor: pointer;
    }

    .photoBtn img{
      width: 100%;
      height: 140px;
      object-fit: cover;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,0.10);
      display: block;
      transition: transform 0.18s ease;
    }

    .photoBtn:hover img{
      transform: scale(1.03);
    }

    .galItem{
      border: 1px solid rgba(0,0,0,0.08);
      border-radius: 12px;
      background: rgba(255,255,255,0.75);
      overflow: hidden;
    }

    .galGrid{
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
      margin-top: 10px;
    }

    @media (max-width: 700px){
      .galGrid{ grid-template-columns: 1fr; }
    }

    .galSummary{
      list-style: none;
      cursor: pointer;
      user-select: none;
      position: relative;
      padding: 0;
      min-height: 170px;
      overflow: hidden;
    }

    .galSummary::-webkit-details-marker{ display:none; }

    .galPreview{
      position: absolute;
      inset: 0;
      background-image: var(--bg);
      background-size: cover;
      background-position: center;
      filter: saturate(1.05) contrast(1.02);
      transform: scale(1);
      transition: transform 0.25s ease;
    }

    .galOverlay{
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      gap: 6px;
      min-height: 170px;
      padding: 14px 16px;
      color: #fff;
      background: linear-gradient(180deg, rgba(0,0,0,0.05) 0%, rgba(0,0,0,0.55) 100%);
      text-shadow: 0 2px 6px rgba(0,0,0,0.35);
    }

    .galTitle{
      font-size: 18px;
      letter-spacing: 0.02em;
    }

    .galMeta{
      font-size: 12px;
      font-weight: 700;
      opacity: 0.9;
    }

    .galCaret{
      font-size: 18px;
      opacity: 0.7;
      transform: rotate(-90deg);
      transition: transform 0.18s ease;
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 2;
      width: 32px;
      height: 32px;
      display: grid;
      place-items: center;
      border-radius: 10px;
      background: rgba(0,0,0,0.35);
      border: 1px solid rgba(255,255,255,0.25);
      color: #fff;
    }

    details[open] .galCaret{
      transform: rotate(0deg);
    }

    .galBody{
      padding: 0 12px 12px 12px;
      border-top: 1px solid rgba(0,0,0,0.08);
    }

    .galItem:hover .galPreview{
      transform: scale(1.04);
    }

    .noScroll{
      overflow: hidden;
    }

    .lightbox{
      position: fixed;
      inset: 0;
      display: none;
      z-index: 9999;
    }

    .lightbox.open{
      display: block;
    }

    .lbBackdrop{
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.75);
    }

    .lbPanel{
      position: absolute;
      inset: 0;
      display: grid;
      place-items: center;
      padding: 20px;
    }

    .lbImg{
      max-width: min(92vw, 980px);
      max-height: 82vh;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.06);
    }

    .lbClose{
      position: absolute;
      top: 14px;
      right: 14px;
      width: 40px;
      height: 40px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.35);
      color: #fff;
      font-size: 26px;
      line-height: 36px;
      cursor: pointer;
    }

    .lbNav{
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 46px;
      height: 56px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.35);
      color: #fff;
      font-size: 34px;
      cursor: pointer;
      user-select: none;
    }

    .lbPrev{ left: 14px; }
    .lbNext{ right: 14px; }

    .lbCounter{
      position: absolute;
      bottom: 14px;
      left: 50%;
      transform: translateX(-50%);
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.35);
      color: #fff;
      font-weight: 700;
      font-size: 12px;
    }

    .videoLightbox{
      position: fixed;
      inset: 0;
      display: none;
      z-index: 9999;
    }

    .videoLightbox.open{
      display: block;
    }

    .videoPanel{
      position: absolute;
      inset: 0;
      display: grid;
      place-items: center;
      padding: 20px;
    }

    .videoFrame{
      width: min(92vw, 980px);
      aspect-ratio: 16 / 9;
      height: auto;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.2);
    }

    .videoClose{
      position: absolute;
      top: 14px;
      right: 14px;
      width: 40px;
      height: 40px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.35);
      color: #fff;
      font-size: 26px;
      line-height: 36px;
      cursor: pointer;
      z-index: 2;
    }
  </style>

  <div class="titleRow" style="position:relative; width:100%;">
    <div class="titleNav" style="position:absolute; top:-16px; right:-6px; z-index:5; display:flex; align-items:center;">
      <a class="titleArrow" href="/viajes/mexico" aria-label="Siguiente" style="margin-left:-8px;">
        <img src="/giroderecha.png" alt="" style="width:72px; height:72px; object-fit:contain; display:block;" />
      </a>
    </div>
    <h1 class="pageTitle">
      Argentina
      <img class="flag-arg" src="/flags/flagargentina.gif" alt="Bandera de Argentina" />
    </h1>
  </div>

  <div class="hero">
    <img class="heroImg" src="/perito.png" alt="Perito Moreno" />
    <div class="pad">
      <p class="muted caption">El Perito Moreno es el glaciar más grande y espectacular que he visitado.</p>
    </div>
  </div>

    <div class="toc">
    <a href="#resumen">Resumen</a>
    <a href="#itinerario">Itinerario</a>
    <a href="#imprescindibles">Imprescindibles</a>
    <a href="#costes">Costes</a>
    <a href="#hoteles">Hoteles</a>
    <a href="#mapa">Mapa</a>
    <a href="#galeria">Galería</a>
  </div>

  <details class="sec" id="resumen">
    <summary class="secSummary">
      <span>Resumen</span><span class="secCaret">&#9662;</span>
    </summary>
    <div class="secBody">
      <p>
        La Ruta Gaucha es un viaje de 25 días por Argentina de norte a sur: arranca en Buenos Aires, sube a la selva de Iguazú, cruza por el norte andino (zona Salta / Purmamarca) y baja a la Patagonia con El Calafate y el glaciar Perito Moreno, para rematar en Ushuaia y Tierra del Fuego, el fin del mundo de verdad. Es una ruta hecha para paisajes y contrastes, no para tachar monumentos.
      </p>
    </div>
  </details>

  <details class="sec" id="itinerario">
    <summary class="secSummary">
      <span>Itinerario</span><span class="secCaret">&#9662;</span>
    </summary>
    <div class="secBody">
      <div class="dayList">
        {itinerario.map((d) => {
          const nextDay = nextExistingDay(d.day);
          const hasText = typeof d.text === "string" && d.text.trim().length > 0;

          return (
            <details class="day" id={`dia-${d.day}`}>
              <summary class="daySummary">Día {d.day} - {d.title}</summary>

              <div class="dayBody">
                {hasText ? <p class="dayText">{d.text}</p> : <p class="dots">...</p>}

                {nextDay && (
                  <div class="nextRow">
                    <a class="nextBtn" href={`#dia-${nextDay}`}>Siguiente día &#10148;</a>
                  </div>
                )}
              </div>
            </details>
          );
        })}
      </div>
    </div>
  </details>

  <details class="sec" id="imprescindibles">
    <summary class="secSummary">
      <span>Imprescindibles</span><span class="secCaret">&#9662;</span>
    </summary>
    <div class="secBody">
      <Imprescindibles3D client:load />
    </div>
  </details>

  <details class="sec" id="costes">
    <summary class="secSummary">
      <span>Costes</span><span class="secCaret">&#9662;</span>
    </summary>
    <div class="secBody">
      <p class="dots">...</p>
    </div>
  </details>

  <details class="sec" id="hoteles">
    <summary class="secSummary"><span>Hoteles</span><span class="secCaret">&#9662;</span></summary>
    <div class="secBody">
      <div class="hotelItem" data-hotel>
        <button class="hotelToggle" type="button">
          <span class="hotelTitle">
            Hotel Recoleta Grand Buenos Aires
            <span class="hotelStars" aria-hidden="true">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
          </span>
          <span class="hotelCaret">&#9662;</span>
        </button>
        <div class="hotelPanel">
          <div class="hotelInfo">
            <div class="muted">Av. Gral. Las Heras 1745, C1018 Cdad. Autónoma de Buenos Aires, Argentina</div>
            <div class="muted">Precio: <strong>362 &euro;</strong> / noche</div>
            <div class="muted">Web: <a href="https://www.recoletagrand.com/" target="_blank" rel="noopener">recoletagrand.com</a></div>
          </div>
          <div class="hotelMedia">
            <img class="hotelPhoto" src="/hoteles/harg1.jpg" alt="Hotel Recoleta Grand - foto 1" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/harg2.jpg" alt="Hotel Recoleta Grand - foto 2" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/harg3.jpg" alt="Hotel Recoleta Grand - foto 3" loading="lazy" />
          </div>
          <iframe
            class="hotelMap"
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3284.4741757550446!2d-58.39360252446988!3d-34.592169272958394!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x95bccabcfca7a58b%3A0x313ed311c088fbcb!2sRecoleta%20Grand%2C%20Buenos%20Aires%2C%20a%20Tribute%20Portfolio%20Hotel!5e0!3m2!1ses!2ses!4v1770141840011!5m2!1ses!2ses"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            title="Mapa Hotel Recoleta Grand"
          ></iframe>
        </div>
      </div>
      <div class="hotelItem" data-hotel>
        <button class="hotelToggle" type="button">
          <span class="hotelTitle">
            Loi Suites Iguazú Hotel
            <span class="hotelStars" aria-hidden="true">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
          </span>
          <span class="hotelCaret">&#9662;</span>
        </button>
        <div class="hotelPanel">
          <div class="hotelInfo">
            <div class="muted">Selva Iryapú s/n, N3370 Puerto Iguazú, Misiones, Argentina</div>
            <div class="muted">Precio: <strong>266 &euro;</strong> / noche</div>
            <div class="muted">Web: <a href="https://loisuites.com.ar/iguazu.html" target="_blank" rel="noopener">loisuites.com.ar</a></div>
          </div>
          <div class="hotelMedia">
            <img class="hotelPhoto" src="/hoteles/higu2.jpg" alt="Loi Suites Iguazú - foto 1" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/higu3.jpg" alt="Loi Suites Iguazú - foto 2" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/higu4.jpg" alt="Loi Suites Iguazú - foto 3" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/higu5.jpg" alt="Loi Suites Iguazú - foto 4" loading="lazy" />
          </div>
          <iframe
            class="hotelMap"
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d7196.500340204833!2d-54.545521!3d-25.596601999999997!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94f693bf9a59d3e7%3A0xa9a6f8a4d5921302!2sLoi%20Suites%20Iguazú%C3%BA%20Hotel!5e0!3m2!1ses!2ses!4v1770143421747!5m2!1ses!2ses"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            title="Mapa Loi Suites Iguazú"
          ></iframe>
        </div>
      </div>
      <div class="hotelItem" data-hotel>
        <button class="hotelToggle" type="button">
          <span class="hotelTitle">
            Hotel Legado Mítico Salta
            <span class="hotelStars" aria-hidden="true">&#9733;&#9733;&#9733;&#9733;</span>
          </span>
          <span class="hotelCaret">&#9662;</span>
        </button>
        <div class="hotelPanel">
          <div class="hotelInfo">
            <div class="muted">Bartolomé Mitre 647, A4400 EHM, Salta, Argentina</div>
            <div class="muted">Precio: <strong>224 &euro;</strong> / noche</div>
            <div class="muted">Web: <a href="https://legadomitico.com/salta/" target="_blank" rel="noopener">legadomitico.com</a></div>
          </div>
          <div class="hotelMedia">
            <img class="hotelPhoto" src="/hoteles/hsal1.jpg" alt="Hotel Legado Mítico Salta - foto 1" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/hsal2.jpg" alt="Hotel Legado Mítico Salta - foto 2" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/hsal3.jpg" alt="Hotel Legado Mítico Salta - foto 3" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/hsal4.jpg" alt="Hotel Legado Mítico Salta - foto 4" loading="lazy" />
          </div>
          <iframe
            class="hotelMap"
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1811.2037468077936!2d-65.41150018007096!3d-24.78149636620746!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x941bc3bed2e1bf7b%3A0x322e0bc0ff194f6b!2sHotel%20Legado%20M%C3%ADtico%20Salta!5e0!3m2!1ses!2ses!4v1770144407629!5m2!1ses!2ses"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            title="Mapa Hotel Legado Mítico Salta"
          ></iframe>
        </div>
      </div>
      <div class="hotelItem" data-hotel>
        <button class="hotelToggle" type="button">
          <span class="hotelTitle">
            Hotel El Manantial del Silencio
            <span class="hotelStars" aria-hidden="true">&#9733;&#9733;&#9733;&#9733;</span>
          </span>
          <span class="hotelCaret">&#9662;</span>
        </button>
        <div class="hotelPanel">
          <div class="hotelInfo">
            <div class="muted">Ruta Nacional N52 Km 3,5, Y4618 Purmamarca, Jujuy, Argentina</div>
            <div class="muted">Precio: <strong>Pendiente</strong></div>
            <div class="muted">Web: <a href="http://www.hotelmanantialdelsilencio.com/" target="_blank" rel="noopener">hotelmanantialdelsilencio.com</a></div>
          </div>
          <div class="hotelMedia">
            <img class="hotelPhoto" src="/hoteles/hpur1.jpg" alt="Hotel El Manantial del Silencio - foto 1" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/hpur2.jpg" alt="Hotel El Manantial del Silencio - foto 2" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/hpur3.jpg" alt="Hotel El Manantial del Silencio - foto 3" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/hpur4.jpg" alt="Hotel El Manantial del Silencio - foto 4" loading="lazy" />
          </div>
          <iframe
            class="hotelMap"
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2132.0274651783125!2d-65.50423509959425!3d-23.742466939678792!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x941b49ca833a1183%3A0x897de17cd130cd87!2sHotel%20El%20Manantial%20del%20Silencio!5e0!3m2!1ses!2ses!4v1770145058607!5m2!1ses!2ses"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            title="Mapa Hotel El Manantial del Silencio"
          ></iframe>
        </div>
      </div>
      <div class="hotelItem" data-hotel>
        <button class="hotelToggle" type="button">
          <span class="hotelTitle">
            Los Cauquenes Resort + Spa + Experiences
            <span class="hotelStars" aria-hidden="true">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
          </span>
          <span class="hotelCaret">&#9662;</span>
        </button>
        <div class="hotelPanel">
          <div class="hotelInfo">
            <div class="muted">Barrio Bahía Cauquén, De la Ermita 3462, V9410 Ushuaia, Tierra del Fuego, Argentina</div>
            <div class="muted">Precio: <strong>336 &euro;</strong> / noche</div>
            <div class="muted">Web: <a href="https://www.loscauquenes.com/es/" target="_blank" rel="noopener">loscauquenes.com</a></div>
          </div>
          <div class="hotelMedia">
            <img class="hotelPhoto" src="/hoteles/husu1.jpg" alt="Los Cauquenes - foto 1" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/husu2.jpg" alt="Los Cauquenes - foto 2" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/husu3.jpg" alt="Los Cauquenes - foto 3" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/husu4.jpg" alt="Los Cauquenes - foto 4" loading="lazy" />
          </div>
          <iframe
            class="hotelMap"
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d18382.150002637693!2d-68.3858858184877!3d-54.83674708305094!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xbc4c2488171315e5%3A0xa2d5f3c1ca32267f!2sLos%20Cauquenes%20Resort%20%2B%20Spa%20%2B%20Experiences!5e0!3m2!1ses!2ses!4v1770145919417!5m2!1ses!2ses"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            title="Mapa Los Cauquenes Resort + Spa + Experiences"
          ></iframe>
        </div>
      </div>
      <div class="hotelItem" data-hotel>
        <button class="hotelToggle" type="button">
          <span class="hotelTitle">
            Xelena Hotel & Suites
            <span class="hotelStars" aria-hidden="true">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
          </span>
          <span class="hotelCaret">&#9662;</span>
        </button>
        <div class="hotelPanel">
          <div class="hotelInfo">
            <div class="muted">Rene Favaloro 3500, Z9405 El Calafate, Santa Cruz, Argentina</div>
            <div class="muted">Precio: <strong>199 &euro;</strong> / noche</div>
            <div class="muted">Web: <a href="http://www.hotelxelena.com/" target="_blank" rel="noopener">hotelxelena.com</a></div>
          </div>
          <div class="hotelMedia">
            <img class="hotelPhoto" src="/hoteles/hcal1.jpg" alt="Xelena Hotel & Suites - foto 1" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/hcal2.jpg" alt="Xelena Hotel & Suites - foto 2" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/hcal3.jpg" alt="Xelena Hotel & Suites - foto 3" loading="lazy" />
            <img class="hotelPhoto" src="/hoteles/hcal4.jpg" alt="Xelena Hotel & Suites - foto 4" loading="lazy" />
          </div>
          <iframe
            class="hotelMap"
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d5093.369940296534!2d-72.30331129999999!3d-50.335128399999995!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xbdbb0cd7e3c07e69%3A0xd7326674c4e3032c!2sXelena%20Hotel%20%26%20Suites!5e0!3m2!1ses!2ses!4v1770146055885!5m2!1ses!2ses"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            title="Mapa Xelena Hotel & Suites"
          ></iframe>
        </div>
      </div>
    </div>
  </details>
  <details class="sec" id="mapa">
    <summary class="secSummary">
      <span>Mapa</span><span class="secCaret">&#9662;</span>
    </summary>
    <div class="secBody">
      <div class="mapWrap">
        <div class="mapBox">
          <button class="mapBtn" type="button" id="openMap">
            <img class="mapImg" src="/maps/mapa_argentina.png" alt="Mapa de Argentina (ruta)" />
          </button>
        </div>
      </div>

      <p class="dots">Próximamente: mapa interactivo.</p>
    </div>
  </details>

  <details class="sec" id="galeria">
    <summary class="secSummary">
      <span>Galería</span><span class="secCaret">&#9662;</span>
    </summary>
    <div class="secBody">
      <div class="galGrid">
        <details class="galItem">
          <summary class="galSummary">
            <div class="galPreview" style="--bg: url('/perito.png');"></div>
            <div class="galOverlay">
              <span class="galTitle">Vídeos</span>
              <span class="galMeta">9 vídeos</span>
            </div>
            <span class="galCaret">&#9662;</span>
          </summary>
          <div class="galBody">
          <div class="videoGrid">
            <button class="videoBtn" type="button" data-video="https://www.youtube.com/embed/9EjcFCl4EgE">
              <iframe src="https://www.youtube.com/embed/9EjcFCl4EgE" allowfullscreen></iframe>
            </button>
            <button class="videoBtn" type="button" data-video="https://www.youtube.com/embed/9gDVJ3nsbjE">
              <iframe src="https://www.youtube.com/embed/9gDVJ3nsbjE" allowfullscreen></iframe>
            </button>
            <button class="videoBtn" type="button" data-video="https://www.youtube.com/embed/MuWJ-onE2Rw">
              <iframe src="https://www.youtube.com/embed/MuWJ-onE2Rw" allowfullscreen></iframe>
            </button>
            <button class="videoBtn" type="button" data-video="https://www.youtube.com/embed/xYxQ_LIKkXs">
              <iframe src="https://www.youtube.com/embed/xYxQ_LIKkXs" allowfullscreen></iframe>
            </button>
            <button class="videoBtn" type="button" data-video="https://www.youtube.com/embed/Hms2foj1WPQ">
              <iframe src="https://www.youtube.com/embed/Hms2foj1WPQ" allowfullscreen></iframe>
            </button>
            <button class="videoBtn" type="button" data-video="https://www.youtube.com/embed/7GNv-GpOZA0">
              <iframe src="https://www.youtube.com/embed/7GNv-GpOZA0" allowfullscreen></iframe>
            </button>
            <button class="videoBtn" type="button" data-video="https://www.youtube.com/embed/l6qduhBFv20">
              <iframe src="https://www.youtube.com/embed/l6qduhBFv20" allowfullscreen></iframe>
            </button>
            <button class="videoBtn" type="button" data-video="https://www.youtube.com/embed/wEbehw_ghtg">
              <iframe src="https://www.youtube.com/embed/wEbehw_ghtg" allowfullscreen></iframe>
            </button>
            <button class="videoBtn" type="button" data-video="https://www.youtube.com/embed/zLfggdJgItE">
              <iframe src="https://www.youtube.com/embed/zLfggdJgItE" allowfullscreen></iframe>
            </button>
          </div>
          </div>
        </details>

        <details class="galItem">
          <summary class="galSummary">
            <div class="galPreview" style="--bg: url('/galeria/arg1.jpg');"></div>
            <div class="galOverlay">
              <span class="galTitle">Fotos</span>
              <span class="galMeta">18 fotos</span>
            </div>
            <span class="galCaret">&#9662;</span>
          </summary>
          <div class="galBody">
            <div class="photoGrid" id="photoGrid">
              <button class="photoBtn" type="button"><img src="/galeria/arg1.jpg" alt="Argentina 1" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg2.jpg" alt="Argentina 2" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg3.jpg" alt="Argentina 3" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg4.jpg" alt="Argentina 4" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg5.jpg" alt="Argentina 5" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg6.jpg" alt="Argentina 6" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg7.jpg" alt="Argentina 7" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg8.png" alt="Argentina 8" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg9.jpg" alt="Argentina 9" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg10.jpg" alt="Argentina 10" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg11.jpg" alt="Argentina 11" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg12.jpg" alt="Argentina 12" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg13.jpg" alt="Argentina 13" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg14.jpg" alt="Argentina 14" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg15.jpg" alt="Argentina 15" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg16.jpg" alt="Argentina 16" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg17.jpg" alt="Argentina 17" loading="lazy" /></button>
              <button class="photoBtn" type="button"><img src="/galeria/arg18.jpg" alt="Argentina 18" loading="lazy" /></button>
            </div>
          </div>
        </details>
      </div>

    </div>
  </details>

  <!-- LIGHTBOX (fotos + mapa) -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <div class="lbBackdrop" id="lbBackdrop"></div>

    <div class="lbPanel" role="dialog" aria-modal="true" aria-label="Galería">
      <button class="lbClose" type="button" id="lbClose" aria-label="Cerrar">×</button>

      <button class="lbNav lbPrev" type="button" id="lbPrev" aria-label="Anterior">‹</button>
      <img class="lbImg" id="lbImg" alt="" />
      <button class="lbNav lbNext" type="button" id="lbNext" aria-label="Siguiente">›</button>

      <div class="lbCounter" id="lbCounter">1 / 1</div>
    </div>
  </div>

  <!-- LIGHTBOX (vídeos) -->
  <div class="videoLightbox" id="videoLightbox" aria-hidden="true">
    <div class="lbBackdrop" id="videoBackdrop"></div>
    <div class="videoPanel" role="dialog" aria-modal="true" aria-label="Vídeo">
      <button class="videoClose" type="button" id="videoClose" aria-label="Cerrar">×</button>
      <iframe class="videoFrame" id="videoFrame" src="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
    </div>
  </div>

  <script is:inline>
    (function () {
      // --- SECCIONES: abrir por hash / toc ---
      const getDetailsById = (id) => document.getElementById(id);

      const openSection = (id) => {
        const d = getDetailsById(id);
        if (d && d.tagName.toLowerCase() === "details") d.open = true;
        return d;
      };

      const closeAllSectionsExcept = (keepId) => {
        document.querySelectorAll("details.sec").forEach((d) => {
          if (d.id !== keepId) d.open = false;
        });
      };

      const openFromHash = () => {
        const raw = (location.hash || "").slice(1);
        if (!raw) {
          openSection("resumen");
          closeAllSectionsExcept("resumen");
          return;
        }

        // Si es un día del itinerario
        if (raw.startsWith("dia-")) {
          const it = openSection("itinerario");
          closeAllSectionsExcept("itinerario");

          const dayEl = document.getElementById(raw);
          if (dayEl && dayEl.tagName.toLowerCase() === "details") {
            dayEl.open = true;
            setTimeout(() => dayEl.scrollIntoView({ behavior: "smooth", block: "start" }), 50);
          } else if (it) {
            setTimeout(() => it.scrollIntoView({ behavior: "smooth", block: "start" }), 50);
          }
          return;
        }

        // Si es una sección
        const sec = openSection(raw);
        if (sec) {
          closeAllSectionsExcept(raw);
          setTimeout(() => sec.scrollIntoView({ behavior: "smooth", block: "start" }), 50);
        }
      };

      // Click en la barra: abrir y cerrar el resto
      document.querySelectorAll(".toc a").forEach((a) => {
        a.addEventListener("click", () => {
          const id = (a.getAttribute("href") || "").replace("#", "");
          if (!id) return;
          openSection(id);
          closeAllSectionsExcept(id);
        });
      });

      window.addEventListener("hashchange", openFromHash);
      openFromHash();

      // Itinerario: solo un día abierto a la vez
      const dayDetails = Array.from(document.querySelectorAll("details.day"));
      dayDetails.forEach((d) => {
        d.addEventListener("toggle", () => {
          if (!d.open) return;
          dayDetails.forEach((other) => {
            if (other !== d) other.open = false;
          });
        });
      });

      // --- LIGHTBOX (fotos + mapa) ---
      const grid = document.getElementById("photoGrid");
      const openMapBtn = document.getElementById("openMap");

      const lightbox = document.getElementById("lightbox");
      const backdrop = document.getElementById("lbBackdrop");
      const btnClose = document.getElementById("lbClose");
      const btnPrev = document.getElementById("lbPrev");
      const btnNext = document.getElementById("lbNext");
      const imgEl = document.getElementById("lbImg");
      const counter = document.getElementById("lbCounter");

      if (!lightbox || !imgEl) return;

      const MAP_SRC = "/maps/mapa_argentina.png";

      const imgs = grid ? Array.from(grid.querySelectorAll("img")) : [];
      let index = 0;
      let mode = "photos"; // "photos" | "map" | "hotel"
      let activeImgs = imgs;

      const showNav = () => {
        if (btnPrev) btnPrev.style.display = "";
        if (btnNext) btnNext.style.display = "";
      };

      const hideNav = () => {
        if (btnPrev) btnPrev.style.display = "none";
        if (btnNext) btnNext.style.display = "none";
      };

      const setImage = (i) => {
        if (!activeImgs.length) return;
        index = (i + activeImgs.length) % activeImgs.length;
        const src = activeImgs[index].getAttribute("src") || "";
        const alt = activeImgs[index].getAttribute("alt") || "";
        imgEl.setAttribute("src", src);
        imgEl.setAttribute("alt", alt);
        if (counter) counter.textContent = (index + 1) + " / " + activeImgs.length;
      };

      const openLightbox = () => {
        lightbox.classList.add("open");
        lightbox.setAttribute("aria-hidden", "false");
        document.documentElement.classList.add("noScroll");
      };

      const closeLightbox = () => {
        lightbox.classList.remove("open");
        lightbox.setAttribute("aria-hidden", "true");
        document.documentElement.classList.remove("noScroll");
        imgEl.removeAttribute("src");
        showNav();
        mode = "photos";
        activeImgs = imgs;
      };

      const openPhoto = (i) => {
        mode = "photos";
        activeImgs = imgs;
        showNav();
        setImage(i);
        openLightbox();
      };

      const openHotel = (i, list) => {
        mode = "hotel";
        activeImgs = list;
        showNav();
        setImage(i);
        openLightbox();
      };

      const openMap = () => {
        if (lightbox.classList.contains("open") && mode === "map") {
          closeLightbox();
          return;
        }
        mode = "map";
        hideNav();
        imgEl.setAttribute("src", MAP_SRC);
        imgEl.setAttribute("alt", "Mapa de Argentina (ruta)");
        if (counter) counter.textContent = "Mapa";
        openLightbox();
      };

      const prev = () => setImage(index - 1);
      const next = () => setImage(index + 1);

      if (grid) {
        grid.addEventListener("click", (e) => {
          const targetImg = e.target && e.target.closest ? e.target.closest("img") : null;
          if (!targetImg) return;
          const i = imgs.indexOf(targetImg);
          if (i >= 0) openPhoto(i);
        });
      }
      const hotelImgs = Array.from(document.querySelectorAll(".hotelPhoto"));
      if (hotelImgs.length) {
        hotelImgs.forEach((img) => {
          img.addEventListener("click", () => {
            const hotelItem = img.closest(".hotelItem");
            const list = hotelItem ? Array.from(hotelItem.querySelectorAll(".hotelPhoto")) : [];
            const i = list.indexOf(img);
            if (i >= 0) openHotel(i, list);
          });
        });
      }

      if (openMapBtn) openMapBtn.addEventListener("click", openMap);

      if (btnClose) btnClose.addEventListener("click", closeLightbox);
      if (backdrop) backdrop.addEventListener("click", closeLightbox);
      if (imgEl) imgEl.addEventListener("click", () => { if (mode === "map") closeLightbox(); });

      if (btnPrev) btnPrev.addEventListener("click", () => { if (mode === "photos" || mode === "hotel") prev(); });
      if (btnNext) btnNext.addEventListener("click", () => { if (mode === "photos" || mode === "hotel") next(); });

      // --- LIGHTBOX (vídeos) ---
      const videoButtons = Array.from(document.querySelectorAll(".videoBtn"));
      const videoLightbox = document.getElementById("videoLightbox");
      const videoBackdrop = document.getElementById("videoBackdrop");
      const videoClose = document.getElementById("videoClose");
      const videoFrame = document.getElementById("videoFrame");

      const openVideo = (src) => {
        if (!videoLightbox || !videoFrame) return;
        videoFrame.setAttribute("src", src + "?autoplay=1");
        videoLightbox.classList.add("open");
        videoLightbox.setAttribute("aria-hidden", "false");
        document.documentElement.classList.add("noScroll");
      };

      const closeVideo = () => {
        if (!videoLightbox || !videoFrame) return;
        videoLightbox.classList.remove("open");
        videoLightbox.setAttribute("aria-hidden", "true");
        document.documentElement.classList.remove("noScroll");
        videoFrame.setAttribute("src", "");
      };

      videoButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const src = btn.getAttribute("data-video");
          if (src) openVideo(src);
        });
      });

      if (videoBackdrop) videoBackdrop.addEventListener("click", closeVideo);
      if (videoClose) videoClose.addEventListener("click", closeVideo);

      window.addEventListener("keydown", (e) => {
        if (!lightbox.classList.contains("open")) return;
        if (e.key === "Escape") closeLightbox();
        if (mode !== "photos" && mode !== "hotel") return;
        if (e.key === "ArrowLeft") prev();
        if (e.key === "ArrowRight") next();
      });

      window.addEventListener("keydown", (e) => {
        if (e.key === "Escape") closeVideo();
      });

      const hotelItems = Array.from(document.querySelectorAll("[data-hotel]"));
      hotelItems.forEach((item) => {
        const btn = item.querySelector(".hotelToggle");
        if (!btn) return;
        btn.addEventListener("click", () => {
          hotelItems.forEach((other) => {
            if (other !== item) other.classList.remove("open");
          });
          item.classList.toggle("open");
        });
      });

      let startX = 0;
      let dx = 0;

      const onTouchStart = (e) => {
        if (!lightbox.classList.contains("open")) return;
        if (mode !== "photos" && mode !== "hotel") return;
        startX = e.touches[0].clientX;
        dx = 0;
      };

      const onTouchMove = (e) => {
        if (!lightbox.classList.contains("open")) return;
        if (mode !== "photos" && mode !== "hotel") return;
        dx = e.touches[0].clientX - startX;
      };

      const onTouchEnd = () => {
        if (!lightbox.classList.contains("open")) return;
        if (mode !== "photos" && mode !== "hotel") return;
        if (Math.abs(dx) > 45) {
          if (dx > 0) prev();
          else next();
        }
        startX = 0;
        dx = 0;
      };

      lightbox.addEventListener("touchstart", onTouchStart, { passive: true });
      lightbox.addEventListener("touchmove", onTouchMove, { passive: true });
      lightbox.addEventListener("touchend", onTouchEnd, { passive: true });
    })();
  </script>
</BaseLayout>

























